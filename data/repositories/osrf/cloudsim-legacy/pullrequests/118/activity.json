{"pagelen": 50, "values": [{"update": {"description": "And an invocation in start_sim.bash (router side)\r\n\r\nThis is the mail script:\r\n\r\n```\r\n#!python\r\n#!/usr/bin/python\r\n\r\n#\r\n# Send a mail to to drcsim-support@osrfoundation.com\r\n# postfix should be installed on your system\r\n\r\ntry:\r\n    import sys\r\n    import smtplib\r\n    import datetime\r\n\r\n    _from = sys.argv[1]\r\n    subject = sys.argv[2]\r\n\r\n    text = \"at %s UTC\" % datetime.datetime.utcnow()\r\n    server = smtplib.SMTP('localhost')\r\n    server.set_debuglevel(1)\r\n\r\n    fromaddr = \"%s@osrfoundation.org\" % _from\r\n    toaddr_list = [\"hugo@osrfoundation.org\"]\r\n    content = ('From: %s\\r\\nTo: %s\\r\\nSubject: %s\\n\\n%s'\r\n                   % (fromaddr, \", \".join(toaddr_list), subject, text))\r\n    server.sendmail(fromaddr, toaddr_list, content)\r\n    server.quit()\r\nfinally:\r\n    print(\"Done\")\r\n\r\n\r\n```\r\n\r\nThis is the new start_sim.bash\r\n\r\n```\r\n#!python\r\n\r\n#!/bin/bash\r\n\r\n/home/ubuntu/cloudsim/mail_ping.py router-10 \"Simulation $1 $2 starting\" &\r\n\r\n# Just rename the old network usage file\r\nsudo mv /tmp/vrc_netwatcher_usage.log /tmp/vrc_netwatcher_usage_`date | tr -d ' '`.log || true\r\n\r\n\r\n# Stop the latency injection\r\nsudo stop vrc_controller_private\r\nsudo stop vrc_controller_public\r\n\r\n# Restore the default tc rules\r\nsudo vrc_init_tc.py bond0\r\nsudo vrc_init_tc.py bond1\r\n\r\nsudo iptables -F FORWARD\r\nsudo stop vrc_netwatcher\r\nkill -9 $(ps aux | grep vrc_netwatcher | awk '{print $2}') || true\r\nsudo stop vrc_bytecounter\r\nsudo start vrc_netwatcher\r\nif ! ssh -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no -i ./key-sim.pem ubuntu@ \"nohup bash cloudsim/start_sim.bash $1 $2 $3 > ssh_start_sim.out 2> ssh_start_sim.err < /dev/null\"; then\r\n  echo \"[router start_sim.bash] simulator start_sim.bash returned non-zero\"\r\n  exit 1\r\nfi\r\n\r\n```", "title": "a script for the router that sends an email when a simulation is started", "destination": {"commit": {"hash": "ce7814d0c04a", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/cloudsim-legacy/commit/ce7814d0c04a.json"}, "html": {"href": "#!/osrf/cloudsim-legacy/commits/ce7814d0c04a"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/cloudsim-legacy.json"}, "html": {"href": "#!/osrf/cloudsim-legacy"}, "avatar": {"href": "data/bytebucket.org/ravatar/{e799e7f6-0caa-464a-97f8-8605a37ebfb1}ts=python"}}, "type": "repository", "name": "cloudsim-legacy", "full_name": "osrf/cloudsim-legacy", "uuid": "{e799e7f6-0caa-464a-97f8-8605a37ebfb1}"}, "branch": {"name": "default"}}, "reason": "not needed anymore", "source": {"commit": {"hash": "b66be5870d69", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/cloudsim-legacy/commit/b66be5870d69.json"}, "html": {"href": "#!/osrf/cloudsim-legacy/commits/b66be5870d69"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/cloudsim-legacy.json"}, "html": {"href": "#!/osrf/cloudsim-legacy"}, "avatar": {"href": "data/bytebucket.org/ravatar/{e799e7f6-0caa-464a-97f8-8605a37ebfb1}ts=python"}}, "type": "repository", "name": "cloudsim-legacy", "full_name": "osrf/cloudsim-legacy", "uuid": "{e799e7f6-0caa-464a-97f8-8605a37ebfb1}"}, "branch": {"name": "mail_on_start"}}, "state": "DECLINED", "author": {"display_name": "Hugo Boyer", "uuid": "{3d87874e-7099-4981-b04f-57f0272faa7d}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B3d87874e-7099-4981-b04f-57f0272faa7d%7D"}, "html": {"href": "https://bitbucket.org/%7B3d87874e-7099-4981-b04f-57f0272faa7d%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/21198da8539b599e3633017f5f5f8150d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsHB-6.png"}}, "nickname": "hugomatic", "type": "user", "account_id": "557058:869c02bb-b246-4cdc-9db3-0064e8add185"}, "date": "2013-09-17T22:20:30.068141+00:00"}, "pull_request": {"type": "pullrequest", "id": 118, "links": {"self": {"href": "data/repositories/osrf/cloudsim-legacy/pullrequests/118.json"}, "html": {"href": "#!/osrf/cloudsim-legacy/pull-requests/118"}}, "title": "a script for the router that sends an email when a simulation is started"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/cloudsim-legacy/pullrequests/118/comments/399602.json"}, "html": {"href": "#!/osrf/cloudsim-legacy/pull-requests/118/_/diff#comment-399602"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 118, "links": {"self": {"href": "data/repositories/osrf/cloudsim-legacy/pullrequests/118.json"}, "html": {"href": "#!/osrf/cloudsim-legacy/pull-requests/118"}}, "title": "a script for the router that sends an email when a simulation is started"}, "content": {"raw": "What do you think of moving the embedded HTML page to a separate file and load it as a template? It'd also make pep8 stop complaining. We could do it in another branch, though.\n\nBTW, I wonder if the Javascript files are subject to XSS attacks. We're not sanitizing the variables we pass to the Javascript scripts, but maybe it's not an issue because they're pulled from the database and we already sanitize them before storing the user data.", "markup": "markdown", "html": "<p>What do you think of moving the embedded HTML page to a separate file and load it as a template? It'd also make pep8 stop complaining. We could do it in another branch, though.</p>\n<p>BTW, I wonder if the Javascript files are subject to XSS attacks. We're not sanitizing the variables we pass to the Javascript scripts, but maybe it's not an issue because they're pulled from the database and we already sanitize them before storing the user data.</p>", "type": "rendered"}, "created_on": "2013-07-22T09:01:51.828310+00:00", "user": {"display_name": "Esteve Fernandez", "uuid": "{b7fa67b3-197b-4687-b526-5583299eb942}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bb7fa67b3-197b-4687-b526-5583299eb942%7D"}, "html": {"href": "https://bitbucket.org/%7Bb7fa67b3-197b-4687-b526-5583299eb942%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/7ed10afdd3c291802b6244f32229c8e1d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsEF-5.png"}}, "nickname": "esteve", "type": "user", "account_id": "557058:58cd8911-f7d9-4a4c-bc21-0f94eb1716d7"}, "updated_on": "2013-07-22T09:01:51.840877+00:00", "type": "pullrequest_comment", "id": 399602}, "pull_request": {"type": "pullrequest", "id": 118, "links": {"self": {"href": "data/repositories/osrf/cloudsim-legacy/pullrequests/118.json"}, "html": {"href": "#!/osrf/cloudsim-legacy/pull-requests/118"}}, "title": "a script for the router that sends an email when a simulation is started"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/cloudsim-legacy/pullrequests/118/comments/399552.json"}, "html": {"href": "#!/osrf/cloudsim-legacy/pull-requests/118/_/diff#comment-399552"}}, "parent": {"id": 332782, "links": {"self": {"href": "data/repositories/osrf/cloudsim-legacy/pullrequests/118/comments/332782.json"}, "html": {"href": "#!/osrf/cloudsim-legacy/pull-requests/118/_/diff#comment-332782"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 118, "links": {"self": {"href": "data/repositories/osrf/cloudsim-legacy/pullrequests/118.json"}, "html": {"href": "#!/osrf/cloudsim-legacy/pull-requests/118"}}, "title": "a script for the router that sends an email when a simulation is started"}, "content": {"raw": "I agree with Carlos, making the recipient list configurable will make it easier for testing the script locally too.", "markup": "markdown", "html": "<p>I agree with Carlos, making the recipient list configurable will make it easier for testing the script locally too.</p>", "type": "rendered"}, "created_on": "2013-07-22T08:38:12.863344+00:00", "user": {"display_name": "Esteve Fernandez", "uuid": "{b7fa67b3-197b-4687-b526-5583299eb942}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bb7fa67b3-197b-4687-b526-5583299eb942%7D"}, "html": {"href": "https://bitbucket.org/%7Bb7fa67b3-197b-4687-b526-5583299eb942%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/7ed10afdd3c291802b6244f32229c8e1d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsEF-5.png"}}, "nickname": "esteve", "type": "user", "account_id": "557058:58cd8911-f7d9-4a4c-bc21-0f94eb1716d7"}, "inline": {}, "updated_on": "2013-07-22T08:38:12.875366+00:00", "type": "pullrequest_comment", "id": 399552}, "pull_request": {"type": "pullrequest", "id": 118, "links": {"self": {"href": "data/repositories/osrf/cloudsim-legacy/pullrequests/118.json"}, "html": {"href": "#!/osrf/cloudsim-legacy/pull-requests/118"}}, "title": "a script for the router that sends an email when a simulation is started"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/cloudsim-legacy/pullrequests/118/comments/339380.json"}, "html": {"href": "#!/osrf/cloudsim-legacy/pull-requests/118/_/diff#comment-339380"}}, "parent": {"id": 332782, "links": {"self": {"href": "data/repositories/osrf/cloudsim-legacy/pullrequests/118/comments/332782.json"}, "html": {"href": "#!/osrf/cloudsim-legacy/pull-requests/118/_/diff#comment-332782"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 118, "links": {"self": {"href": "data/repositories/osrf/cloudsim-legacy/pullrequests/118.json"}, "html": {"href": "#!/osrf/cloudsim-legacy/pull-requests/118"}}, "title": "a script for the router that sends an email when a simulation is started"}, "content": {"raw": "The hole thing should be enabled/disabled via the web interface, too. This is an all or nothing thing at the moment and it could be annoying.", "markup": "markdown", "html": "<p>The hole thing should be enabled/disabled via the web interface, too. This is an all or nothing thing at the moment and it could be annoying.</p>", "type": "rendered"}, "created_on": "2013-06-26T21:56:39.509448+00:00", "user": {"display_name": "Hugo Boyer", "uuid": "{3d87874e-7099-4981-b04f-57f0272faa7d}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B3d87874e-7099-4981-b04f-57f0272faa7d%7D"}, "html": {"href": "https://bitbucket.org/%7B3d87874e-7099-4981-b04f-57f0272faa7d%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/21198da8539b599e3633017f5f5f8150d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsHB-6.png"}}, "nickname": "hugomatic", "type": "user", "account_id": "557058:869c02bb-b246-4cdc-9db3-0064e8add185"}, "inline": {}, "updated_on": "2013-06-26T21:56:39.517402+00:00", "type": "pullrequest_comment", "id": 339380}, "pull_request": {"type": "pullrequest", "id": 118, "links": {"self": {"href": "data/repositories/osrf/cloudsim-legacy/pullrequests/118.json"}, "html": {"href": "#!/osrf/cloudsim-legacy/pull-requests/118"}}, "title": "a script for the router that sends an email when a simulation is started"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/cloudsim-legacy/pullrequests/118/comments/332782.json"}, "html": {"href": "#!/osrf/cloudsim-legacy/pull-requests/118/_/diff#comment-332782"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 118, "links": {"self": {"href": "data/repositories/osrf/cloudsim-legacy/pullrequests/118.json"}, "html": {"href": "#!/osrf/cloudsim-legacy/pull-requests/118"}}, "title": "a script for the router that sends an email when a simulation is started"}, "content": {"raw": "Probably the sender will always be `hostname` but the recipient list might change. I would suggest to change the command line arguments and allow to specify the recipient list. The sender might be hard-coded inside the code with `hostname`.", "markup": "markdown", "html": "<p>Probably the sender will always be <code>hostname</code> but the recipient list might change. I would suggest to change the command line arguments and allow to specify the recipient list. The sender might be hard-coded inside the code with <code>hostname</code>.</p>", "type": "rendered"}, "created_on": "2013-06-24T21:12:36.208764+00:00", "user": {"display_name": "Carlos Ag\u00fcero", "uuid": "{da8a8e89-4bb0-421b-bd0e-dbbed3d4ed6a}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bda8a8e89-4bb0-421b-bd0e-dbbed3d4ed6a%7D"}, "html": {"href": "https://bitbucket.org/%7Bda8a8e89-4bb0-421b-bd0e-dbbed3d4ed6a%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/692bf15758111acaddae4da15a47f9e5d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCA-0.png"}}, "nickname": "caguero", "type": "user", "account_id": "557058:4ded1ddf-947e-4154-bbd1-3dba24f1bdbd"}, "inline": {}, "updated_on": "2013-06-24T21:12:36.222617+00:00", "type": "pullrequest_comment", "id": 332782}, "pull_request": {"type": "pullrequest", "id": 118, "links": {"self": {"href": "data/repositories/osrf/cloudsim-legacy/pullrequests/118.json"}, "html": {"href": "#!/osrf/cloudsim-legacy/pull-requests/118"}}, "title": "a script for the router that sends an email when a simulation is started"}}, {"update": {"description": "And an invocation in start_sim.bash (router side)\r\n\r\nThis is the mail script:\r\n\r\n```\r\n#!python\r\n#!/usr/bin/python\r\n\r\n#\r\n# Send a mail to to drcsim-support@osrfoundation.com\r\n# postfix should be installed on your system\r\n\r\ntry:\r\n    import sys\r\n    import smtplib\r\n    import datetime\r\n\r\n    _from = sys.argv[1]\r\n    subject = sys.argv[2]\r\n\r\n    text = \"at %s UTC\" % datetime.datetime.utcnow()\r\n    server = smtplib.SMTP('localhost')\r\n    server.set_debuglevel(1)\r\n\r\n    fromaddr = \"%s@osrfoundation.org\" % _from\r\n    toaddr_list = [\"hugo@osrfoundation.org\"]\r\n    content = ('From: %s\\r\\nTo: %s\\r\\nSubject: %s\\n\\n%s'\r\n                   % (fromaddr, \", \".join(toaddr_list), subject, text))\r\n    server.sendmail(fromaddr, toaddr_list, content)\r\n    server.quit()\r\nfinally:\r\n    print(\"Done\")\r\n\r\n\r\n```\r\n\r\nThis is the new start_sim.bash\r\n\r\n```\r\n#!python\r\n\r\n#!/bin/bash\r\n\r\n/home/ubuntu/cloudsim/mail_ping.py router-10 \"Simulation $1 $2 starting\" &\r\n\r\n# Just rename the old network usage file\r\nsudo mv /tmp/vrc_netwatcher_usage.log /tmp/vrc_netwatcher_usage_`date | tr -d ' '`.log || true\r\n\r\n\r\n# Stop the latency injection\r\nsudo stop vrc_controller_private\r\nsudo stop vrc_controller_public\r\n\r\n# Restore the default tc rules\r\nsudo vrc_init_tc.py bond0\r\nsudo vrc_init_tc.py bond1\r\n\r\nsudo iptables -F FORWARD\r\nsudo stop vrc_netwatcher\r\nkill -9 $(ps aux | grep vrc_netwatcher | awk '{print $2}') || true\r\nsudo stop vrc_bytecounter\r\nsudo start vrc_netwatcher\r\nif ! ssh -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no -i ./key-sim.pem ubuntu@ \"nohup bash cloudsim/start_sim.bash $1 $2 $3 > ssh_start_sim.out 2> ssh_start_sim.err < /dev/null\"; then\r\n  echo \"[router start_sim.bash] simulator start_sim.bash returned non-zero\"\r\n  exit 1\r\nfi\r\n\r\n```", "title": "a script for the router that sends an email when a simulation is started", "destination": {"commit": {"hash": "d20dc8a2a7b8", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/cloudsim-legacy/commit/d20dc8a2a7b8.json"}, "html": {"href": "#!/osrf/cloudsim-legacy/commits/d20dc8a2a7b8"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/cloudsim-legacy.json"}, "html": {"href": "#!/osrf/cloudsim-legacy"}, "avatar": {"href": "data/bytebucket.org/ravatar/{e799e7f6-0caa-464a-97f8-8605a37ebfb1}ts=python"}}, "type": "repository", "name": "cloudsim-legacy", "full_name": "osrf/cloudsim-legacy", "uuid": "{e799e7f6-0caa-464a-97f8-8605a37ebfb1}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "b66be5870d69", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/cloudsim-legacy/commit/b66be5870d69.json"}, "html": {"href": "#!/osrf/cloudsim-legacy/commits/b66be5870d69"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/cloudsim-legacy.json"}, "html": {"href": "#!/osrf/cloudsim-legacy"}, "avatar": {"href": "data/bytebucket.org/ravatar/{e799e7f6-0caa-464a-97f8-8605a37ebfb1}ts=python"}}, "type": "repository", "name": "cloudsim-legacy", "full_name": "osrf/cloudsim-legacy", "uuid": "{e799e7f6-0caa-464a-97f8-8605a37ebfb1}"}, "branch": {"name": "mail_on_start"}}, "state": "OPEN", "author": {"display_name": "Hugo Boyer", "uuid": "{3d87874e-7099-4981-b04f-57f0272faa7d}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B3d87874e-7099-4981-b04f-57f0272faa7d%7D"}, "html": {"href": "https://bitbucket.org/%7B3d87874e-7099-4981-b04f-57f0272faa7d%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/21198da8539b599e3633017f5f5f8150d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsHB-6.png"}}, "nickname": "hugomatic", "type": "user", "account_id": "557058:869c02bb-b246-4cdc-9db3-0064e8add185"}, "date": "2013-06-14T13:19:56.213685+00:00"}, "pull_request": {"type": "pullrequest", "id": 118, "links": {"self": {"href": "data/repositories/osrf/cloudsim-legacy/pullrequests/118.json"}, "html": {"href": "#!/osrf/cloudsim-legacy/pull-requests/118"}}, "title": "a script for the router that sends an email when a simulation is started"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/cloudsim-legacy/pullrequests/118/comments/311894.json"}, "html": {"href": "#!/osrf/cloudsim-legacy/pull-requests/118/_/diff#comment-311894"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 118, "links": {"self": {"href": "data/repositories/osrf/cloudsim-legacy/pullrequests/118.json"}, "html": {"href": "#!/osrf/cloudsim-legacy/pull-requests/118"}}, "title": "a script for the router that sends an email when a simulation is started"}, "content": {"raw": "In the description above, the email address should be replaced", "markup": "markdown", "html": "<p>In the description above, the email address should be replaced</p>", "type": "rendered"}, "created_on": "2013-06-14T13:11:37.019125+00:00", "user": {"display_name": "Hugo Boyer", "uuid": "{3d87874e-7099-4981-b04f-57f0272faa7d}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B3d87874e-7099-4981-b04f-57f0272faa7d%7D"}, "html": {"href": "https://bitbucket.org/%7B3d87874e-7099-4981-b04f-57f0272faa7d%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/21198da8539b599e3633017f5f5f8150d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsHB-6.png"}}, "nickname": "hugomatic", "type": "user", "account_id": "557058:869c02bb-b246-4cdc-9db3-0064e8add185"}, "updated_on": "2013-06-14T13:11:37.025909+00:00", "type": "pullrequest_comment", "id": 311894}, "pull_request": {"type": "pullrequest", "id": 118, "links": {"self": {"href": "data/repositories/osrf/cloudsim-legacy/pullrequests/118.json"}, "html": {"href": "#!/osrf/cloudsim-legacy/pull-requests/118"}}, "title": "a script for the router that sends an email when a simulation is started"}}, {"update": {"description": "And an invocation in start_sim.bash (router side)\r\n\r\nThis is the mail script:\r\n\r\n```\r\n#!python\r\n#!/usr/bin/python\r\n\r\n#\r\n# Send a mail to to drcsim-support@osrfoundation.com\r\n# postfix should be installed on your system\r\n\r\ntry:\r\n    import sys\r\n    import smtplib\r\n    import datetime\r\n\r\n    _from = sys.argv[1]\r\n    subject = sys.argv[2]\r\n\r\n    text = \"at %s UTC\" % datetime.datetime.utcnow()\r\n    server = smtplib.SMTP('localhost')\r\n    server.set_debuglevel(1)\r\n\r\n    fromaddr = \"%s@osrfoundation.org\" % _from\r\n    toaddr_list = [\"hugo@osrfoundation.org\"]\r\n    content = ('From: %s\\r\\nTo: %s\\r\\nSubject: %s\\n\\n%s'\r\n                   % (fromaddr, \", \".join(toaddr_list), subject, text))\r\n    server.sendmail(fromaddr, toaddr_list, content)\r\n    server.quit()\r\nfinally:\r\n    print(\"Done\")\r\n\r\n\r\n```\r\n\r\nThis is the new start_sim.bash\r\n\r\n```\r\n#!python\r\n\r\n#!/bin/bash\r\n\r\n/home/ubuntu/cloudsim/mail_ping.py router-10 \"Simulation $1 $2 starting\" &\r\n\r\n# Just rename the old network usage file\r\nsudo mv /tmp/vrc_netwatcher_usage.log /tmp/vrc_netwatcher_usage_`date | tr -d ' '`.log || true\r\n\r\n\r\n# Stop the latency injection\r\nsudo stop vrc_controller_private\r\nsudo stop vrc_controller_public\r\n\r\n# Restore the default tc rules\r\nsudo vrc_init_tc.py bond0\r\nsudo vrc_init_tc.py bond1\r\n\r\nsudo iptables -F FORWARD\r\nsudo stop vrc_netwatcher\r\nkill -9 $(ps aux | grep vrc_netwatcher | awk '{print $2}') || true\r\nsudo stop vrc_bytecounter\r\nsudo start vrc_netwatcher\r\nif ! ssh -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no -i ./key-sim.pem ubuntu@ \"nohup bash cloudsim/start_sim.bash $1 $2 $3 > ssh_start_sim.out 2> ssh_start_sim.err < /dev/null\"; then\r\n  echo \"[router start_sim.bash] simulator start_sim.bash returned non-zero\"\r\n  exit 1\r\nfi\r\n\r\n```", "title": "a script for the router that sends an email when a simulation is started", "destination": {"commit": {"hash": "d20dc8a2a7b8", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/cloudsim-legacy/commit/d20dc8a2a7b8.json"}, "html": {"href": "#!/osrf/cloudsim-legacy/commits/d20dc8a2a7b8"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/cloudsim-legacy.json"}, "html": {"href": "#!/osrf/cloudsim-legacy"}, "avatar": {"href": "data/bytebucket.org/ravatar/{e799e7f6-0caa-464a-97f8-8605a37ebfb1}ts=python"}}, "type": "repository", "name": "cloudsim-legacy", "full_name": "osrf/cloudsim-legacy", "uuid": "{e799e7f6-0caa-464a-97f8-8605a37ebfb1}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "54a050ba4028", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/cloudsim-legacy/commit/54a050ba4028.json"}, "html": {"href": "#!/osrf/cloudsim-legacy/commits/54a050ba4028"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/cloudsim-legacy.json"}, "html": {"href": "#!/osrf/cloudsim-legacy"}, "avatar": {"href": "data/bytebucket.org/ravatar/{e799e7f6-0caa-464a-97f8-8605a37ebfb1}ts=python"}}, "type": "repository", "name": "cloudsim-legacy", "full_name": "osrf/cloudsim-legacy", "uuid": "{e799e7f6-0caa-464a-97f8-8605a37ebfb1}"}, "branch": {"name": "mail_on_start"}}, "state": "OPEN", "author": {"display_name": "Hugo Boyer", "uuid": "{3d87874e-7099-4981-b04f-57f0272faa7d}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B3d87874e-7099-4981-b04f-57f0272faa7d%7D"}, "html": {"href": "https://bitbucket.org/%7B3d87874e-7099-4981-b04f-57f0272faa7d%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/21198da8539b599e3633017f5f5f8150d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsHB-6.png"}}, "nickname": "hugomatic", "type": "user", "account_id": "557058:869c02bb-b246-4cdc-9db3-0064e8add185"}, "date": "2013-06-14T13:10:34.435899+00:00"}, "pull_request": {"type": "pullrequest", "id": 118, "links": {"self": {"href": "data/repositories/osrf/cloudsim-legacy/pullrequests/118.json"}, "html": {"href": "#!/osrf/cloudsim-legacy/pull-requests/118"}}, "title": "a script for the router that sends an email when a simulation is started"}}, {"update": {"description": "And an invocation in start_sim.bash (router side)\r\n\r\nThis is the mail script:\r\n\r\n```\r\n#!python\r\n#!/usr/bin/python\r\n\r\n#\r\n# Send a mail to to drcsim-support@osrfoundation.com\r\n# postfix should be installed on your system\r\n\r\ntry:\r\n    import sys\r\n    import smtplib\r\n    import datetime\r\n\r\n    _from = sys.argv[1]\r\n    subject = sys.argv[2]\r\n\r\n    text = \"at %s UTC\" % datetime.datetime.utcnow()\r\n    server = smtplib.SMTP('localhost')\r\n    server.set_debuglevel(1)\r\n\r\n    fromaddr = \"%s@osrfoundation.org\" % _from\r\n    toaddr_list = [\"hugo@osrfoundation.org\"]\r\n    content = ('From: %s\\r\\nTo: %s\\r\\nSubject: %s\\n\\n%s'\r\n                   % (fromaddr, \", \".join(toaddr_list), subject, text))\r\n    server.sendmail(fromaddr, toaddr_list, content)\r\n    server.quit()\r\nfinally:\r\n    print(\"Done\")\r\n\r\n\r\n```\r\n\r\nThis is the new start_sim.bash\r\n\r\n```\r\n#!python\r\n\r\n#!/bin/bash\r\n\r\n/home/ubuntu/cloudsim/mail_ping.py router-10 \"Simulation $1 $2 starting\" &\r\n\r\n# Just rename the old network usage file\r\nsudo mv /tmp/vrc_netwatcher_usage.log /tmp/vrc_netwatcher_usage_`date | tr -d ' '`.log || true\r\n\r\n\r\n# Stop the latency injection\r\nsudo stop vrc_controller_private\r\nsudo stop vrc_controller_public\r\n\r\n# Restore the default tc rules\r\nsudo vrc_init_tc.py bond0\r\nsudo vrc_init_tc.py bond1\r\n\r\nsudo iptables -F FORWARD\r\nsudo stop vrc_netwatcher\r\nkill -9 $(ps aux | grep vrc_netwatcher | awk '{print $2}') || true\r\nsudo stop vrc_bytecounter\r\nsudo start vrc_netwatcher\r\nif ! ssh -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no -i ./key-sim.pem ubuntu@ \"nohup bash cloudsim/start_sim.bash $1 $2 $3 > ssh_start_sim.out 2> ssh_start_sim.err < /dev/null\"; then\r\n  echo \"[router start_sim.bash] simulator start_sim.bash returned non-zero\"\r\n  exit 1\r\nfi\r\n\r\n```", "title": "a script for the router that sends an email when a simulation is started", "destination": {"commit": {"hash": "d20dc8a2a7b8", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/cloudsim-legacy/commit/d20dc8a2a7b8.json"}, "html": {"href": "#!/osrf/cloudsim-legacy/commits/d20dc8a2a7b8"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/cloudsim-legacy.json"}, "html": {"href": "#!/osrf/cloudsim-legacy"}, "avatar": {"href": "data/bytebucket.org/ravatar/{e799e7f6-0caa-464a-97f8-8605a37ebfb1}ts=python"}}, "type": "repository", "name": "cloudsim-legacy", "full_name": "osrf/cloudsim-legacy", "uuid": "{e799e7f6-0caa-464a-97f8-8605a37ebfb1}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "54a050ba4028", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/cloudsim-legacy/commit/54a050ba4028.json"}, "html": {"href": "#!/osrf/cloudsim-legacy/commits/54a050ba4028"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/cloudsim-legacy.json"}, "html": {"href": "#!/osrf/cloudsim-legacy"}, "avatar": {"href": "data/bytebucket.org/ravatar/{e799e7f6-0caa-464a-97f8-8605a37ebfb1}ts=python"}}, "type": "repository", "name": "cloudsim-legacy", "full_name": "osrf/cloudsim-legacy", "uuid": "{e799e7f6-0caa-464a-97f8-8605a37ebfb1}"}, "branch": {"name": "mail_on_start"}}, "state": "OPEN", "author": {"display_name": "Hugo Boyer", "uuid": "{3d87874e-7099-4981-b04f-57f0272faa7d}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B3d87874e-7099-4981-b04f-57f0272faa7d%7D"}, "html": {"href": "https://bitbucket.org/%7B3d87874e-7099-4981-b04f-57f0272faa7d%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/21198da8539b599e3633017f5f5f8150d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsHB-6.png"}}, "nickname": "hugomatic", "type": "user", "account_id": "557058:869c02bb-b246-4cdc-9db3-0064e8add185"}, "date": "2013-06-14T13:10:34.399112+00:00"}, "pull_request": {"type": "pullrequest", "id": 118, "links": {"self": {"href": "data/repositories/osrf/cloudsim-legacy/pullrequests/118.json"}, "html": {"href": "#!/osrf/cloudsim-legacy/pull-requests/118"}}, "title": "a script for the router that sends an email when a simulation is started"}}]}