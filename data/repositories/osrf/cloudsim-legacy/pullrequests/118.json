{"rendered": {"reason": {"raw": "not needed anymore", "markup": "markdown", "html": "<p>not needed anymore</p>", "type": "rendered"}, "description": {"raw": "And an invocation in start_sim.bash (router side)\r\n\r\nThis is the mail script:\r\n\r\n```\r\n#!python\r\n#!/usr/bin/python\r\n\r\n#\r\n# Send a mail to to drcsim-support@osrfoundation.com\r\n# postfix should be installed on your system\r\n\r\ntry:\r\n    import sys\r\n    import smtplib\r\n    import datetime\r\n\r\n    _from = sys.argv[1]\r\n    subject = sys.argv[2]\r\n\r\n    text = \"at %s UTC\" % datetime.datetime.utcnow()\r\n    server = smtplib.SMTP('localhost')\r\n    server.set_debuglevel(1)\r\n\r\n    fromaddr = \"%s@osrfoundation.org\" % _from\r\n    toaddr_list = [\"hugo@osrfoundation.org\"]\r\n    content = ('From: %s\\r\\nTo: %s\\r\\nSubject: %s\\n\\n%s'\r\n                   % (fromaddr, \", \".join(toaddr_list), subject, text))\r\n    server.sendmail(fromaddr, toaddr_list, content)\r\n    server.quit()\r\nfinally:\r\n    print(\"Done\")\r\n\r\n\r\n```\r\n\r\nThis is the new start_sim.bash\r\n\r\n```\r\n#!python\r\n\r\n#!/bin/bash\r\n\r\n/home/ubuntu/cloudsim/mail_ping.py router-10 \"Simulation $1 $2 starting\" &\r\n\r\n# Just rename the old network usage file\r\nsudo mv /tmp/vrc_netwatcher_usage.log /tmp/vrc_netwatcher_usage_`date | tr -d ' '`.log || true\r\n\r\n\r\n# Stop the latency injection\r\nsudo stop vrc_controller_private\r\nsudo stop vrc_controller_public\r\n\r\n# Restore the default tc rules\r\nsudo vrc_init_tc.py bond0\r\nsudo vrc_init_tc.py bond1\r\n\r\nsudo iptables -F FORWARD\r\nsudo stop vrc_netwatcher\r\nkill -9 $(ps aux | grep vrc_netwatcher | awk '{print $2}') || true\r\nsudo stop vrc_bytecounter\r\nsudo start vrc_netwatcher\r\nif ! ssh -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no -i ./key-sim.pem ubuntu@ \"nohup bash cloudsim/start_sim.bash $1 $2 $3 > ssh_start_sim.out 2> ssh_start_sim.err < /dev/null\"; then\r\n  echo \"[router start_sim.bash] simulator start_sim.bash returned non-zero\"\r\n  exit 1\r\nfi\r\n\r\n```", "markup": "markdown", "html": "<p>And an invocation in start_sim.bash (router side)</p>\n<p>This is the mail script:</p>\n<div class=\"codehilite language-python\"><pre><span></span><span class=\"ch\">#!/usr/bin/python</span>\n\n<span class=\"c1\">#</span>\n<span class=\"c1\"># Send a mail to to drcsim-support@osrfoundation.com</span>\n<span class=\"c1\"># postfix should be installed on your system</span>\n\n<span class=\"k\">try</span><span class=\"p\">:</span>\n    <span class=\"kn\">import</span> <span class=\"nn\">sys</span>\n    <span class=\"kn\">import</span> <span class=\"nn\">smtplib</span>\n    <span class=\"kn\">import</span> <span class=\"nn\">datetime</span>\n\n    <span class=\"n\">_from</span> <span class=\"o\">=</span> <span class=\"n\">sys</span><span class=\"o\">.</span><span class=\"n\">argv</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span>\n    <span class=\"n\">subject</span> <span class=\"o\">=</span> <span class=\"n\">sys</span><span class=\"o\">.</span><span class=\"n\">argv</span><span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">]</span>\n\n    <span class=\"n\">text</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;at </span><span class=\"si\">%s</span><span class=\"s2\"> UTC&quot;</span> <span class=\"o\">%</span> <span class=\"n\">datetime</span><span class=\"o\">.</span><span class=\"n\">datetime</span><span class=\"o\">.</span><span class=\"n\">utcnow</span><span class=\"p\">()</span>\n    <span class=\"n\">server</span> <span class=\"o\">=</span> <span class=\"n\">smtplib</span><span class=\"o\">.</span><span class=\"n\">SMTP</span><span class=\"p\">(</span><span class=\"s1\">&#39;localhost&#39;</span><span class=\"p\">)</span>\n    <span class=\"n\">server</span><span class=\"o\">.</span><span class=\"n\">set_debuglevel</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">)</span>\n\n    <span class=\"n\">fromaddr</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;</span><span class=\"si\">%s</span><span class=\"s2\">@osrfoundation.org&quot;</span> <span class=\"o\">%</span> <span class=\"n\">_from</span>\n    <span class=\"n\">toaddr_list</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"s2\">&quot;hugo@osrfoundation.org&quot;</span><span class=\"p\">]</span>\n    <span class=\"n\">content</span> <span class=\"o\">=</span> <span class=\"p\">(</span><span class=\"s1\">&#39;From: </span><span class=\"si\">%s</span><span class=\"se\">\\r\\n</span><span class=\"s1\">To: </span><span class=\"si\">%s</span><span class=\"se\">\\r\\n</span><span class=\"s1\">Subject: </span><span class=\"si\">%s</span><span class=\"se\">\\n\\n</span><span class=\"si\">%s</span><span class=\"s1\">&#39;</span>\n                   <span class=\"o\">%</span> <span class=\"p\">(</span><span class=\"n\">fromaddr</span><span class=\"p\">,</span> <span class=\"s2\">&quot;, &quot;</span><span class=\"o\">.</span><span class=\"n\">join</span><span class=\"p\">(</span><span class=\"n\">toaddr_list</span><span class=\"p\">),</span> <span class=\"n\">subject</span><span class=\"p\">,</span> <span class=\"n\">text</span><span class=\"p\">))</span>\n    <span class=\"n\">server</span><span class=\"o\">.</span><span class=\"n\">sendmail</span><span class=\"p\">(</span><span class=\"n\">fromaddr</span><span class=\"p\">,</span> <span class=\"n\">toaddr_list</span><span class=\"p\">,</span> <span class=\"n\">content</span><span class=\"p\">)</span>\n    <span class=\"n\">server</span><span class=\"o\">.</span><span class=\"n\">quit</span><span class=\"p\">()</span>\n<span class=\"k\">finally</span><span class=\"p\">:</span>\n    <span class=\"k\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;Done&quot;</span><span class=\"p\">)</span>\n</pre></div>\n\n\n<p>This is the new start_sim.bash</p>\n<div class=\"codehilite language-python\"><pre><span></span><span class=\"ch\">#!/bin/bash</span>\n\n<span class=\"o\">/</span><span class=\"n\">home</span><span class=\"o\">/</span><span class=\"n\">ubuntu</span><span class=\"o\">/</span><span class=\"n\">cloudsim</span><span class=\"o\">/</span><span class=\"n\">mail_ping</span><span class=\"o\">.</span><span class=\"n\">py</span> <span class=\"n\">router</span><span class=\"o\">-</span><span class=\"mi\">10</span> <span class=\"s2\">&quot;Simulation $1 $2 starting&quot;</span> <span class=\"o\">&amp;</span>\n\n<span class=\"c1\"># Just rename the old network usage file</span>\n<span class=\"n\">sudo</span> <span class=\"n\">mv</span> <span class=\"o\">/</span><span class=\"n\">tmp</span><span class=\"o\">/</span><span class=\"n\">vrc_netwatcher_usage</span><span class=\"o\">.</span><span class=\"n\">log</span> <span class=\"o\">/</span><span class=\"n\">tmp</span><span class=\"o\">/</span><span class=\"n\">vrc_netwatcher_usage_</span><span class=\"sb\">`date | tr -d &#39; &#39;`</span><span class=\"o\">.</span><span class=\"n\">log</span> <span class=\"o\">||</span> <span class=\"n\">true</span>\n\n\n<span class=\"c1\"># Stop the latency injection</span>\n<span class=\"n\">sudo</span> <span class=\"n\">stop</span> <span class=\"n\">vrc_controller_private</span>\n<span class=\"n\">sudo</span> <span class=\"n\">stop</span> <span class=\"n\">vrc_controller_public</span>\n\n<span class=\"c1\"># Restore the default tc rules</span>\n<span class=\"n\">sudo</span> <span class=\"n\">vrc_init_tc</span><span class=\"o\">.</span><span class=\"n\">py</span> <span class=\"n\">bond0</span>\n<span class=\"n\">sudo</span> <span class=\"n\">vrc_init_tc</span><span class=\"o\">.</span><span class=\"n\">py</span> <span class=\"n\">bond1</span>\n\n<span class=\"n\">sudo</span> <span class=\"n\">iptables</span> <span class=\"o\">-</span><span class=\"n\">F</span> <span class=\"n\">FORWARD</span>\n<span class=\"n\">sudo</span> <span class=\"n\">stop</span> <span class=\"n\">vrc_netwatcher</span>\n<span class=\"n\">kill</span> <span class=\"o\">-</span><span class=\"mi\">9</span> <span class=\"err\">$</span><span class=\"p\">(</span><span class=\"n\">ps</span> <span class=\"n\">aux</span> <span class=\"o\">|</span> <span class=\"n\">grep</span> <span class=\"n\">vrc_netwatcher</span> <span class=\"o\">|</span> <span class=\"n\">awk</span> <span class=\"s1\">&#39;{print $2}&#39;</span><span class=\"p\">)</span> <span class=\"o\">||</span> <span class=\"n\">true</span>\n<span class=\"n\">sudo</span> <span class=\"n\">stop</span> <span class=\"n\">vrc_bytecounter</span>\n<span class=\"n\">sudo</span> <span class=\"n\">start</span> <span class=\"n\">vrc_netwatcher</span>\n<span class=\"k\">if</span> <span class=\"err\">!</span> <span class=\"n\">ssh</span> <span class=\"o\">-</span><span class=\"n\">o</span> <span class=\"n\">UserKnownHostsFile</span><span class=\"o\">=/</span><span class=\"n\">dev</span><span class=\"o\">/</span><span class=\"n\">null</span> <span class=\"o\">-</span><span class=\"n\">o</span> <span class=\"n\">StrictHostKeyChecking</span><span class=\"o\">=</span><span class=\"n\">no</span> <span class=\"o\">-</span><span class=\"n\">i</span> <span class=\"o\">./</span><span class=\"n\">key</span><span class=\"o\">-</span><span class=\"n\">sim</span><span class=\"o\">.</span><span class=\"n\">pem</span> <span class=\"n\">ubuntu</span><span class=\"err\">@</span> <span class=\"s2\">&quot;nohup bash cloudsim/start_sim.bash $1 $2 $3 &gt; ssh_start_sim.out 2&gt; ssh_start_sim.err &lt; /dev/null&quot;</span><span class=\"p\">;</span> <span class=\"n\">then</span>\n  <span class=\"n\">echo</span> <span class=\"s2\">&quot;[router start_sim.bash] simulator start_sim.bash returned non-zero&quot;</span>\n  <span class=\"nb\">exit</span> <span class=\"mi\">1</span>\n<span class=\"n\">fi</span>\n</pre></div>", "type": "rendered"}, "title": {"raw": "a script for the router that sends an email when a simulation is started", "markup": "markdown", "html": "<p>a script for the router that sends an email when a simulation is started</p>", "type": "rendered"}}, "type": "pullrequest", "description": "And an invocation in start_sim.bash (router side)\r\n\r\nThis is the mail script:\r\n\r\n```\r\n#!python\r\n#!/usr/bin/python\r\n\r\n#\r\n# Send a mail to to drcsim-support@osrfoundation.com\r\n# postfix should be installed on your system\r\n\r\ntry:\r\n    import sys\r\n    import smtplib\r\n    import datetime\r\n\r\n    _from = sys.argv[1]\r\n    subject = sys.argv[2]\r\n\r\n    text = \"at %s UTC\" % datetime.datetime.utcnow()\r\n    server = smtplib.SMTP('localhost')\r\n    server.set_debuglevel(1)\r\n\r\n    fromaddr = \"%s@osrfoundation.org\" % _from\r\n    toaddr_list = [\"hugo@osrfoundation.org\"]\r\n    content = ('From: %s\\r\\nTo: %s\\r\\nSubject: %s\\n\\n%s'\r\n                   % (fromaddr, \", \".join(toaddr_list), subject, text))\r\n    server.sendmail(fromaddr, toaddr_list, content)\r\n    server.quit()\r\nfinally:\r\n    print(\"Done\")\r\n\r\n\r\n```\r\n\r\nThis is the new start_sim.bash\r\n\r\n```\r\n#!python\r\n\r\n#!/bin/bash\r\n\r\n/home/ubuntu/cloudsim/mail_ping.py router-10 \"Simulation $1 $2 starting\" &\r\n\r\n# Just rename the old network usage file\r\nsudo mv /tmp/vrc_netwatcher_usage.log /tmp/vrc_netwatcher_usage_`date | tr -d ' '`.log || true\r\n\r\n\r\n# Stop the latency injection\r\nsudo stop vrc_controller_private\r\nsudo stop vrc_controller_public\r\n\r\n# Restore the default tc rules\r\nsudo vrc_init_tc.py bond0\r\nsudo vrc_init_tc.py bond1\r\n\r\nsudo iptables -F FORWARD\r\nsudo stop vrc_netwatcher\r\nkill -9 $(ps aux | grep vrc_netwatcher | awk '{print $2}') || true\r\nsudo stop vrc_bytecounter\r\nsudo start vrc_netwatcher\r\nif ! ssh -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no -i ./key-sim.pem ubuntu@ \"nohup bash cloudsim/start_sim.bash $1 $2 $3 > ssh_start_sim.out 2> ssh_start_sim.err < /dev/null\"; then\r\n  echo \"[router start_sim.bash] simulator start_sim.bash returned non-zero\"\r\n  exit 1\r\nfi\r\n\r\n```", "links": {"decline": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/cloudsim-legacy/pullrequests/118/decline"}, "diffstat": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/cloudsim-legacy/diffstat/osrf/cloudsim-legacy:b66be5870d69%0Dce7814d0c04a?from_pullrequest_id=118"}, "commits": {"href": "data/repositories/osrf/cloudsim-legacy/pullrequests/118/commits.json"}, "self": {"href": "data/repositories/osrf/cloudsim-legacy/pullrequests/118.json"}, "comments": {"href": "data/repositories/osrf/cloudsim-legacy/pullrequests/118/comments_page=1.json"}, "merge": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/cloudsim-legacy/pullrequests/118/merge"}, "html": {"href": "#!/osrf/cloudsim-legacy/pull-requests/118"}, "activity": {"href": "data/repositories/osrf/cloudsim-legacy/pullrequests/118/activity.json"}, "diff": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/cloudsim-legacy/diff/osrf/cloudsim-legacy:b66be5870d69%0Dce7814d0c04a?from_pullrequest_id=118"}, "approve": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/cloudsim-legacy/pullrequests/118/approve"}, "statuses": {"href": "data/repositories/osrf/cloudsim-legacy/pullrequests/118/statuses_page=1.json"}}, "title": "a script for the router that sends an email when a simulation is started", "close_source_branch": false, "reviewers": [], "id": 118, "destination": {"commit": {"hash": "ce7814d0c04a", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/cloudsim-legacy/commit/ce7814d0c04a.json"}, "html": {"href": "#!/osrf/cloudsim-legacy/commits/ce7814d0c04a"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/cloudsim-legacy.json"}, "html": {"href": "#!/osrf/cloudsim-legacy"}, "avatar": {"href": "data/bytebucket.org/ravatar/{e799e7f6-0caa-464a-97f8-8605a37ebfb1}ts=python"}}, "type": "repository", "name": "cloudsim-legacy", "full_name": "osrf/cloudsim-legacy", "uuid": "{e799e7f6-0caa-464a-97f8-8605a37ebfb1}"}, "branch": {"name": "default"}}, "created_on": "2013-06-14T13:10:34.392987+00:00", "summary": {"raw": "And an invocation in start_sim.bash (router side)\r\n\r\nThis is the mail script:\r\n\r\n```\r\n#!python\r\n#!/usr/bin/python\r\n\r\n#\r\n# Send a mail to to drcsim-support@osrfoundation.com\r\n# postfix should be installed on your system\r\n\r\ntry:\r\n    import sys\r\n    import smtplib\r\n    import datetime\r\n\r\n    _from = sys.argv[1]\r\n    subject = sys.argv[2]\r\n\r\n    text = \"at %s UTC\" % datetime.datetime.utcnow()\r\n    server = smtplib.SMTP('localhost')\r\n    server.set_debuglevel(1)\r\n\r\n    fromaddr = \"%s@osrfoundation.org\" % _from\r\n    toaddr_list = [\"hugo@osrfoundation.org\"]\r\n    content = ('From: %s\\r\\nTo: %s\\r\\nSubject: %s\\n\\n%s'\r\n                   % (fromaddr, \", \".join(toaddr_list), subject, text))\r\n    server.sendmail(fromaddr, toaddr_list, content)\r\n    server.quit()\r\nfinally:\r\n    print(\"Done\")\r\n\r\n\r\n```\r\n\r\nThis is the new start_sim.bash\r\n\r\n```\r\n#!python\r\n\r\n#!/bin/bash\r\n\r\n/home/ubuntu/cloudsim/mail_ping.py router-10 \"Simulation $1 $2 starting\" &\r\n\r\n# Just rename the old network usage file\r\nsudo mv /tmp/vrc_netwatcher_usage.log /tmp/vrc_netwatcher_usage_`date | tr -d ' '`.log || true\r\n\r\n\r\n# Stop the latency injection\r\nsudo stop vrc_controller_private\r\nsudo stop vrc_controller_public\r\n\r\n# Restore the default tc rules\r\nsudo vrc_init_tc.py bond0\r\nsudo vrc_init_tc.py bond1\r\n\r\nsudo iptables -F FORWARD\r\nsudo stop vrc_netwatcher\r\nkill -9 $(ps aux | grep vrc_netwatcher | awk '{print $2}') || true\r\nsudo stop vrc_bytecounter\r\nsudo start vrc_netwatcher\r\nif ! ssh -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no -i ./key-sim.pem ubuntu@ \"nohup bash cloudsim/start_sim.bash $1 $2 $3 > ssh_start_sim.out 2> ssh_start_sim.err < /dev/null\"; then\r\n  echo \"[router start_sim.bash] simulator start_sim.bash returned non-zero\"\r\n  exit 1\r\nfi\r\n\r\n```", "markup": "markdown", "html": "<p>And an invocation in start_sim.bash (router side)</p>\n<p>This is the mail script:</p>\n<div class=\"codehilite language-python\"><pre><span></span><span class=\"ch\">#!/usr/bin/python</span>\n\n<span class=\"c1\">#</span>\n<span class=\"c1\"># Send a mail to to drcsim-support@osrfoundation.com</span>\n<span class=\"c1\"># postfix should be installed on your system</span>\n\n<span class=\"k\">try</span><span class=\"p\">:</span>\n    <span class=\"kn\">import</span> <span class=\"nn\">sys</span>\n    <span class=\"kn\">import</span> <span class=\"nn\">smtplib</span>\n    <span class=\"kn\">import</span> <span class=\"nn\">datetime</span>\n\n    <span class=\"n\">_from</span> <span class=\"o\">=</span> <span class=\"n\">sys</span><span class=\"o\">.</span><span class=\"n\">argv</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span>\n    <span class=\"n\">subject</span> <span class=\"o\">=</span> <span class=\"n\">sys</span><span class=\"o\">.</span><span class=\"n\">argv</span><span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">]</span>\n\n    <span class=\"n\">text</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;at </span><span class=\"si\">%s</span><span class=\"s2\"> UTC&quot;</span> <span class=\"o\">%</span> <span class=\"n\">datetime</span><span class=\"o\">.</span><span class=\"n\">datetime</span><span class=\"o\">.</span><span class=\"n\">utcnow</span><span class=\"p\">()</span>\n    <span class=\"n\">server</span> <span class=\"o\">=</span> <span class=\"n\">smtplib</span><span class=\"o\">.</span><span class=\"n\">SMTP</span><span class=\"p\">(</span><span class=\"s1\">&#39;localhost&#39;</span><span class=\"p\">)</span>\n    <span class=\"n\">server</span><span class=\"o\">.</span><span class=\"n\">set_debuglevel</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">)</span>\n\n    <span class=\"n\">fromaddr</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;</span><span class=\"si\">%s</span><span class=\"s2\">@osrfoundation.org&quot;</span> <span class=\"o\">%</span> <span class=\"n\">_from</span>\n    <span class=\"n\">toaddr_list</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"s2\">&quot;hugo@osrfoundation.org&quot;</span><span class=\"p\">]</span>\n    <span class=\"n\">content</span> <span class=\"o\">=</span> <span class=\"p\">(</span><span class=\"s1\">&#39;From: </span><span class=\"si\">%s</span><span class=\"se\">\\r\\n</span><span class=\"s1\">To: </span><span class=\"si\">%s</span><span class=\"se\">\\r\\n</span><span class=\"s1\">Subject: </span><span class=\"si\">%s</span><span class=\"se\">\\n\\n</span><span class=\"si\">%s</span><span class=\"s1\">&#39;</span>\n                   <span class=\"o\">%</span> <span class=\"p\">(</span><span class=\"n\">fromaddr</span><span class=\"p\">,</span> <span class=\"s2\">&quot;, &quot;</span><span class=\"o\">.</span><span class=\"n\">join</span><span class=\"p\">(</span><span class=\"n\">toaddr_list</span><span class=\"p\">),</span> <span class=\"n\">subject</span><span class=\"p\">,</span> <span class=\"n\">text</span><span class=\"p\">))</span>\n    <span class=\"n\">server</span><span class=\"o\">.</span><span class=\"n\">sendmail</span><span class=\"p\">(</span><span class=\"n\">fromaddr</span><span class=\"p\">,</span> <span class=\"n\">toaddr_list</span><span class=\"p\">,</span> <span class=\"n\">content</span><span class=\"p\">)</span>\n    <span class=\"n\">server</span><span class=\"o\">.</span><span class=\"n\">quit</span><span class=\"p\">()</span>\n<span class=\"k\">finally</span><span class=\"p\">:</span>\n    <span class=\"k\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;Done&quot;</span><span class=\"p\">)</span>\n</pre></div>\n\n\n<p>This is the new start_sim.bash</p>\n<div class=\"codehilite language-python\"><pre><span></span><span class=\"ch\">#!/bin/bash</span>\n\n<span class=\"o\">/</span><span class=\"n\">home</span><span class=\"o\">/</span><span class=\"n\">ubuntu</span><span class=\"o\">/</span><span class=\"n\">cloudsim</span><span class=\"o\">/</span><span class=\"n\">mail_ping</span><span class=\"o\">.</span><span class=\"n\">py</span> <span class=\"n\">router</span><span class=\"o\">-</span><span class=\"mi\">10</span> <span class=\"s2\">&quot;Simulation $1 $2 starting&quot;</span> <span class=\"o\">&amp;</span>\n\n<span class=\"c1\"># Just rename the old network usage file</span>\n<span class=\"n\">sudo</span> <span class=\"n\">mv</span> <span class=\"o\">/</span><span class=\"n\">tmp</span><span class=\"o\">/</span><span class=\"n\">vrc_netwatcher_usage</span><span class=\"o\">.</span><span class=\"n\">log</span> <span class=\"o\">/</span><span class=\"n\">tmp</span><span class=\"o\">/</span><span class=\"n\">vrc_netwatcher_usage_</span><span class=\"sb\">`date | tr -d &#39; &#39;`</span><span class=\"o\">.</span><span class=\"n\">log</span> <span class=\"o\">||</span> <span class=\"n\">true</span>\n\n\n<span class=\"c1\"># Stop the latency injection</span>\n<span class=\"n\">sudo</span> <span class=\"n\">stop</span> <span class=\"n\">vrc_controller_private</span>\n<span class=\"n\">sudo</span> <span class=\"n\">stop</span> <span class=\"n\">vrc_controller_public</span>\n\n<span class=\"c1\"># Restore the default tc rules</span>\n<span class=\"n\">sudo</span> <span class=\"n\">vrc_init_tc</span><span class=\"o\">.</span><span class=\"n\">py</span> <span class=\"n\">bond0</span>\n<span class=\"n\">sudo</span> <span class=\"n\">vrc_init_tc</span><span class=\"o\">.</span><span class=\"n\">py</span> <span class=\"n\">bond1</span>\n\n<span class=\"n\">sudo</span> <span class=\"n\">iptables</span> <span class=\"o\">-</span><span class=\"n\">F</span> <span class=\"n\">FORWARD</span>\n<span class=\"n\">sudo</span> <span class=\"n\">stop</span> <span class=\"n\">vrc_netwatcher</span>\n<span class=\"n\">kill</span> <span class=\"o\">-</span><span class=\"mi\">9</span> <span class=\"err\">$</span><span class=\"p\">(</span><span class=\"n\">ps</span> <span class=\"n\">aux</span> <span class=\"o\">|</span> <span class=\"n\">grep</span> <span class=\"n\">vrc_netwatcher</span> <span class=\"o\">|</span> <span class=\"n\">awk</span> <span class=\"s1\">&#39;{print $2}&#39;</span><span class=\"p\">)</span> <span class=\"o\">||</span> <span class=\"n\">true</span>\n<span class=\"n\">sudo</span> <span class=\"n\">stop</span> <span class=\"n\">vrc_bytecounter</span>\n<span class=\"n\">sudo</span> <span class=\"n\">start</span> <span class=\"n\">vrc_netwatcher</span>\n<span class=\"k\">if</span> <span class=\"err\">!</span> <span class=\"n\">ssh</span> <span class=\"o\">-</span><span class=\"n\">o</span> <span class=\"n\">UserKnownHostsFile</span><span class=\"o\">=/</span><span class=\"n\">dev</span><span class=\"o\">/</span><span class=\"n\">null</span> <span class=\"o\">-</span><span class=\"n\">o</span> <span class=\"n\">StrictHostKeyChecking</span><span class=\"o\">=</span><span class=\"n\">no</span> <span class=\"o\">-</span><span class=\"n\">i</span> <span class=\"o\">./</span><span class=\"n\">key</span><span class=\"o\">-</span><span class=\"n\">sim</span><span class=\"o\">.</span><span class=\"n\">pem</span> <span class=\"n\">ubuntu</span><span class=\"err\">@</span> <span class=\"s2\">&quot;nohup bash cloudsim/start_sim.bash $1 $2 $3 &gt; ssh_start_sim.out 2&gt; ssh_start_sim.err &lt; /dev/null&quot;</span><span class=\"p\">;</span> <span class=\"n\">then</span>\n  <span class=\"n\">echo</span> <span class=\"s2\">&quot;[router start_sim.bash] simulator start_sim.bash returned non-zero&quot;</span>\n  <span class=\"nb\">exit</span> <span class=\"mi\">1</span>\n<span class=\"n\">fi</span>\n</pre></div>", "type": "rendered"}, "source": {"commit": {"hash": "b66be5870d69", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/cloudsim-legacy/commit/b66be5870d69.json"}, "html": {"href": "#!/osrf/cloudsim-legacy/commits/b66be5870d69"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/cloudsim-legacy.json"}, "html": {"href": "#!/osrf/cloudsim-legacy"}, "avatar": {"href": "data/bytebucket.org/ravatar/{e799e7f6-0caa-464a-97f8-8605a37ebfb1}ts=python"}}, "type": "repository", "name": "cloudsim-legacy", "full_name": "osrf/cloudsim-legacy", "uuid": "{e799e7f6-0caa-464a-97f8-8605a37ebfb1}"}, "branch": {"name": "mail_on_start"}}, "comment_count": 5, "state": "DECLINED", "task_count": 0, "participants": [{"role": "PARTICIPANT", "participated_on": "2013-06-26T21:56:39.517402+00:00", "type": "participant", "approved": false, "user": {"display_name": "Hugo Boyer", "uuid": "{3d87874e-7099-4981-b04f-57f0272faa7d}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B3d87874e-7099-4981-b04f-57f0272faa7d%7D"}, "html": {"href": "https://bitbucket.org/%7B3d87874e-7099-4981-b04f-57f0272faa7d%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/21198da8539b599e3633017f5f5f8150d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsHB-6.png"}}, "nickname": "hugomatic", "type": "user", "account_id": "557058:869c02bb-b246-4cdc-9db3-0064e8add185"}}, {"role": "PARTICIPANT", "participated_on": "2013-06-24T21:12:36.222617+00:00", "type": "participant", "approved": false, "user": {"display_name": "Carlos Ag\u00fcero", "uuid": "{da8a8e89-4bb0-421b-bd0e-dbbed3d4ed6a}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bda8a8e89-4bb0-421b-bd0e-dbbed3d4ed6a%7D"}, "html": {"href": "https://bitbucket.org/%7Bda8a8e89-4bb0-421b-bd0e-dbbed3d4ed6a%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/692bf15758111acaddae4da15a47f9e5d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCA-0.png"}}, "nickname": "caguero", "type": "user", "account_id": "557058:4ded1ddf-947e-4154-bbd1-3dba24f1bdbd"}}, {"role": "PARTICIPANT", "participated_on": "2013-07-22T09:01:51.840877+00:00", "type": "participant", "approved": false, "user": {"display_name": "Esteve Fernandez", "uuid": "{b7fa67b3-197b-4687-b526-5583299eb942}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bb7fa67b3-197b-4687-b526-5583299eb942%7D"}, "html": {"href": "https://bitbucket.org/%7Bb7fa67b3-197b-4687-b526-5583299eb942%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/7ed10afdd3c291802b6244f32229c8e1d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsEF-5.png"}}, "nickname": "esteve", "type": "user", "account_id": "557058:58cd8911-f7d9-4a4c-bc21-0f94eb1716d7"}}], "reason": "not needed anymore", "updated_on": "2013-09-17T22:20:30.052942+00:00", "author": {"display_name": "Hugo Boyer", "uuid": "{3d87874e-7099-4981-b04f-57f0272faa7d}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B3d87874e-7099-4981-b04f-57f0272faa7d%7D"}, "html": {"href": "https://bitbucket.org/%7B3d87874e-7099-4981-b04f-57f0272faa7d%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/21198da8539b599e3633017f5f5f8150d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsHB-6.png"}}, "nickname": "hugomatic", "type": "user", "account_id": "557058:869c02bb-b246-4cdc-9db3-0064e8add185"}, "merge_commit": null, "closed_by": {"display_name": "Hugo Boyer", "uuid": "{3d87874e-7099-4981-b04f-57f0272faa7d}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B3d87874e-7099-4981-b04f-57f0272faa7d%7D"}, "html": {"href": "https://bitbucket.org/%7B3d87874e-7099-4981-b04f-57f0272faa7d%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/21198da8539b599e3633017f5f5f8150d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsHB-6.png"}}, "nickname": "hugomatic", "type": "user", "account_id": "557058:869c02bb-b246-4cdc-9db3-0064e8add185"}}