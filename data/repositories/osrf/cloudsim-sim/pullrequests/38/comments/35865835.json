{"links": {"self": {"href": "data/repositories/osrf/cloudsim-sim/pullrequests/38/comments/35865835.json"}, "code": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/cloudsim-sim/diff/osrf/cloudsim-sim:210ddd7e5434..5afa3579b388?path=src_commands%2Ffc_stop_team_docker.bash"}, "html": {"href": "#!/osrf/cloudsim-sim/pull-requests/38/_/diff#comment-35865835"}}, "parent": {"id": 35864497, "links": {"self": {"href": "data/repositories/osrf/cloudsim-sim/pullrequests/38/comments/35864497.json"}, "html": {"href": "#!/osrf/cloudsim-sim/pull-requests/38/_/diff#comment-35864497"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 38, "links": {"self": {"href": "data/repositories/osrf/cloudsim-sim/pullrequests/38.json"}, "html": {"href": "#!/osrf/cloudsim-sim/pull-requests/38"}}, "title": "aws scripts and src commands related to field computer"}, "content": {"raw": "That's unexpected. I don't see anything wrong with the script. Are you saying it displays `TIMEOUT TIMEOUT TIMEOUT`?\n\nI commented out the docker commands and replaced the wait with a sleep for 5 seconds, and I get the expected output. The script sleeps for 5 seconds and returns.\n\n```\n#!/usr/bin/env bash\n\n# Fork command for timeout handling\n{\n    # Stop the container after 2 minutes\n    sleep 120\n    echo \"TIMEOUT TIMEOUT TIMEOUT\"\n    docker stop team_container\n} &\ntimer_pid=$!\necho \"timer pid: $timer_pid\"\n\n# docker kill --signal \"SIGINT\" team_container \necho \"sent SIGINT signal to 'team_container' container for smooth shutdown\"\necho \"about to wait for 'team_container' container to stop\"\n#docker wait team_container\nsleep 5\necho \"team_container stopped\"\n# The container stopped after sigint, cancel the timeout fork\nkill -SIGKILL $timer_pid\necho \"exiting fc_stop_team_docker\"\nexit 0\n```\n\n```\n$ ./test.bash \ntimer pid: 3066\nsent SIGINT signal to 'team_container' container for smooth shutdown\nabout to wait for 'team_container' container to stop\nteam_container stopped\nexiting fc_stop_team_docker\n```\n\nIs it possible the container isn't exiting? During those 120 seconds does `docker ps` show team_container as still running?", "markup": "markdown", "html": "<p>That's unexpected. I don't see anything wrong with the script. Are you saying it displays <code>TIMEOUT TIMEOUT TIMEOUT</code>?</p>\n<p>I commented out the docker commands and replaced the wait with a sleep for 5 seconds, and I get the expected output. The script sleeps for 5 seconds and returns.</p>\n<div class=\"codehilite language-bash\"><pre><span></span><span class=\"ch\">#!/usr/bin/env bash</span>\n\n<span class=\"c1\"># Fork command for timeout handling</span>\n<span class=\"o\">{</span>\n    <span class=\"c1\"># Stop the container after 2 minutes</span>\n    sleep <span class=\"m\">120</span>\n    <span class=\"nb\">echo</span> <span class=\"s2\">&quot;TIMEOUT TIMEOUT TIMEOUT&quot;</span>\n    docker stop team_container\n<span class=\"o\">}</span> <span class=\"p\">&amp;</span>\n<span class=\"nv\">timer_pid</span><span class=\"o\">=</span><span class=\"nv\">$!</span>\n<span class=\"nb\">echo</span> <span class=\"s2\">&quot;timer pid: </span><span class=\"nv\">$timer_pid</span><span class=\"s2\">&quot;</span>\n\n<span class=\"c1\"># docker kill --signal &quot;SIGINT&quot; team_container </span>\n<span class=\"nb\">echo</span> <span class=\"s2\">&quot;sent SIGINT signal to &#39;team_container&#39; container for smooth shutdown&quot;</span>\n<span class=\"nb\">echo</span> <span class=\"s2\">&quot;about to wait for &#39;team_container&#39; container to stop&quot;</span>\n<span class=\"c1\">#docker wait team_container</span>\nsleep <span class=\"m\">5</span>\n<span class=\"nb\">echo</span> <span class=\"s2\">&quot;team_container stopped&quot;</span>\n<span class=\"c1\"># The container stopped after sigint, cancel the timeout fork</span>\n<span class=\"nb\">kill</span> -SIGKILL <span class=\"nv\">$timer_pid</span>\n<span class=\"nb\">echo</span> <span class=\"s2\">&quot;exiting fc_stop_team_docker&quot;</span>\n<span class=\"nb\">exit</span> <span class=\"m\">0</span>\n</pre></div>\n\n\n<div class=\"codehilite\"><pre><span></span>$ ./test.bash \ntimer pid: <span class=\"m\">3066</span>\nsent SIGINT signal to <span class=\"s1\">&#39;team_container&#39;</span> container <span class=\"k\">for</span> smooth shutdown\nabout to <span class=\"nb\">wait</span> <span class=\"k\">for</span> <span class=\"s1\">&#39;team_container&#39;</span> container to stop\nteam_container stopped\nexiting fc_stop_team_docker\n</pre></div>\n\n\n<p>Is it possible the container isn't exiting? During those 120 seconds does <code>docker ps</code> show team_container as still running?</p>", "type": "rendered"}, "created_on": "2017-04-27T21:44:23.445065+00:00", "user": {"display_name": "Shane Loretz", "uuid": "{656e3311-aad9-45a1-aaf7-b0ee0e84b287}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B656e3311-aad9-45a1-aaf7-b0ee0e84b287%7D"}, "html": {"href": "https://bitbucket.org/%7B656e3311-aad9-45a1-aaf7-b0ee0e84b287%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:684383ab-ac95-4859-a350-4a6f41a94a22/c7a1ebf5-cade-4115-9f26-9d3facb776db/128"}}, "nickname": "Shane Loretz", "type": "user", "account_id": "557058:684383ab-ac95-4859-a350-4a6f41a94a22"}, "inline": {"to": null, "from": null, "outdated": false, "path": "src_commands/fc_stop_team_docker.bash"}, "updated_on": "2017-04-27T21:44:38.067084+00:00", "type": "pullrequest_comment", "id": 35865835}