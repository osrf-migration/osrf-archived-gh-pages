{"priority": "major", "kind": "bug", "repository": {"links": {"self": {"href": "data/repositories/osrf/cloudsim-portal.json"}, "html": {"href": "#!/osrf/cloudsim-portal"}, "avatar": {"href": "data/bytebucket.org/ravatar/{ccc09dfa-4343-4a4f-8bdc-a83865647cef}ts=default"}}, "type": "repository", "name": "cloudsim-portal", "full_name": "osrf/cloudsim-portal", "uuid": "{ccc09dfa-4343-4a4f-8bdc-a83865647cef}"}, "links": {"attachments": {"href": "data/repositories/osrf/cloudsim-portal/issues/13/attachments_page=1.json"}, "self": {"href": "data/repositories/osrf/cloudsim-portal/issues/13.json"}, "watch": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/cloudsim-portal/issues/13/watch"}, "comments": {"href": "data/repositories/osrf/cloudsim-portal/issues/13/comments_page=1.json"}, "html": {"href": "#!/osrf/cloudsim-portal/issues/13/occasional-bad-state-transition-from"}, "vote": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/cloudsim-portal/issues/13/vote"}}, "reporter": {"display_name": "Hugo Boyer", "uuid": "{3d87874e-7099-4981-b04f-57f0272faa7d}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B3d87874e-7099-4981-b04f-57f0272faa7d%7D"}, "html": {"href": "https://bitbucket.org/%7B3d87874e-7099-4981-b04f-57f0272faa7d%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/21198da8539b599e3633017f5f5f8150d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsHB-6.png"}}, "nickname": "hugomatic", "type": "user", "account_id": "557058:869c02bb-b246-4cdc-9db3-0064e8add185"}, "title": "occasional bad state transition from LAUNCHING to TERMINATED", "component": null, "votes": 0, "watches": 0, "content": {"raw": "It is possible for a new machine status to be set wrongly to TERMINATED. This happens occasionally in `server/controllers/simulator.js::updateInstanceStatus`\r\n\r\nProblem: aws does not return information for the instance (because it's just been launched?), so the function determines that the machine is Terminated. \r\n\r\nfix: maybe allow a minimum time before validating a transition from the  launching state?\r\n\r\n```\r\n#!bash\r\n\r\nThis is what is reported by AWS (machine i-0fb3fe438d72949a0 is missing):\r\n\r\n { 'i-01144079a1aebd393': 'TERMINATED',\r\n  'i-0acdf5da1e56babc3': 'TERMINATED',\r\n  'i-00a29727c176361dd': 'TERMINATED',\r\n  'i-0def8fa94bbfad7f2': 'TERMINATED',\r\n  'i-0324213b66783a865': 'TERMINATED',\r\n  'i-04b1438460a8efd10': 'TERMINATED',\r\n  'i-0f14ed68383f2f94e': 'TERMINATED',\r\n  'i-0fffab3a0aaad1e07': 'TERMINATED',\r\n  'i-07ee7c1fcac4d6084': 'TERMINATED',\r\n  'i-02cf7861ed45b0ee4': 'TERMINATED',\r\n  'i-0bad1af741868f092': 'TERMINATED',\r\n  'i-0cebbfbe059135fd6': 'RUNNING',\r\n  'i-05adbf7b98a0ac7bd': 'TERMINATING',\r\n  'i-035124443f79069bf': 'RUNNING' } \r\n*\r\n\r\nThis is the new state for instance i-0fb3fe438d72949a0\r\n\r\n { status: 'TERMINATED',\r\n  region: 'us-west-1',\r\n  hardware: 'm4.large',\r\n  image: 'ami-ac5500cc',\r\n  creator: 'cloudsim@osrfoundation.org',\r\n  launch_date: '2016-11-14T20:56:19.176Z',\r\n  termination_date: null,\r\n  machine_ip: '',\r\n  machine_id: 'i-0fb3fe438d72949a0',\r\n  id: 'simulator-699' }\r\ni-0fb3fe438d72949a0 simulator-699 status update LAUNCHING => TERMINATED\r\n\r\n\r\n```", "markup": "markdown", "html": "<p>It is possible for a new machine status to be set wrongly to TERMINATED. This happens occasionally in <code>server/controllers/simulator.js::updateInstanceStatus</code></p>\n<p>Problem: aws does not return information for the instance (because it's just been launched?), so the function determines that the machine is Terminated. </p>\n<p>fix: maybe allow a minimum time before validating a transition from the  launching state?</p>\n<div class=\"codehilite language-bash\"><pre><span></span>This is what is reported by AWS <span class=\"o\">(</span>machine i-0fb3fe438d72949a0 is missing<span class=\"o\">)</span>:\n\n <span class=\"o\">{</span> <span class=\"s1\">&#39;i-01144079a1aebd393&#39;</span>: <span class=\"s1\">&#39;TERMINATED&#39;</span>,\n  <span class=\"s1\">&#39;i-0acdf5da1e56babc3&#39;</span>: <span class=\"s1\">&#39;TERMINATED&#39;</span>,\n  <span class=\"s1\">&#39;i-00a29727c176361dd&#39;</span>: <span class=\"s1\">&#39;TERMINATED&#39;</span>,\n  <span class=\"s1\">&#39;i-0def8fa94bbfad7f2&#39;</span>: <span class=\"s1\">&#39;TERMINATED&#39;</span>,\n  <span class=\"s1\">&#39;i-0324213b66783a865&#39;</span>: <span class=\"s1\">&#39;TERMINATED&#39;</span>,\n  <span class=\"s1\">&#39;i-04b1438460a8efd10&#39;</span>: <span class=\"s1\">&#39;TERMINATED&#39;</span>,\n  <span class=\"s1\">&#39;i-0f14ed68383f2f94e&#39;</span>: <span class=\"s1\">&#39;TERMINATED&#39;</span>,\n  <span class=\"s1\">&#39;i-0fffab3a0aaad1e07&#39;</span>: <span class=\"s1\">&#39;TERMINATED&#39;</span>,\n  <span class=\"s1\">&#39;i-07ee7c1fcac4d6084&#39;</span>: <span class=\"s1\">&#39;TERMINATED&#39;</span>,\n  <span class=\"s1\">&#39;i-02cf7861ed45b0ee4&#39;</span>: <span class=\"s1\">&#39;TERMINATED&#39;</span>,\n  <span class=\"s1\">&#39;i-0bad1af741868f092&#39;</span>: <span class=\"s1\">&#39;TERMINATED&#39;</span>,\n  <span class=\"s1\">&#39;i-0cebbfbe059135fd6&#39;</span>: <span class=\"s1\">&#39;RUNNING&#39;</span>,\n  <span class=\"s1\">&#39;i-05adbf7b98a0ac7bd&#39;</span>: <span class=\"s1\">&#39;TERMINATING&#39;</span>,\n  <span class=\"s1\">&#39;i-035124443f79069bf&#39;</span>: <span class=\"s1\">&#39;RUNNING&#39;</span> <span class=\"o\">}</span> \n*\n\nThis is the new state <span class=\"k\">for</span> instance i-0fb3fe438d72949a0\n\n <span class=\"o\">{</span> status: <span class=\"s1\">&#39;TERMINATED&#39;</span>,\n  region: <span class=\"s1\">&#39;us-west-1&#39;</span>,\n  hardware: <span class=\"s1\">&#39;m4.large&#39;</span>,\n  image: <span class=\"s1\">&#39;ami-ac5500cc&#39;</span>,\n  creator: <span class=\"s1\">&#39;cloudsim@osrfoundation.org&#39;</span>,\n  launch_date: <span class=\"s1\">&#39;2016-11-14T20:56:19.176Z&#39;</span>,\n  termination_date: null,\n  machine_ip: <span class=\"s1\">&#39;&#39;</span>,\n  machine_id: <span class=\"s1\">&#39;i-0fb3fe438d72949a0&#39;</span>,\n  id: <span class=\"s1\">&#39;simulator-699&#39;</span> <span class=\"o\">}</span>\ni-0fb3fe438d72949a0 simulator-699 status update <span class=\"nv\">LAUNCHING</span> <span class=\"o\">=</span>&gt; TERMINATED\n</pre></div>", "type": "rendered"}, "assignee": null, "state": "resolved", "version": null, "edited_on": null, "created_on": "2016-11-14T22:31:48.014296+00:00", "milestone": null, "updated_on": "2017-02-08T21:59:22.782787+00:00", "type": "issue", "id": 13}