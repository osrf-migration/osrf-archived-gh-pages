{"links": {"self": {"href": "data/repositories/osrf/cloudsim-portal/pullrequests/101/comments/38930716.json"}, "html": {"href": "#!/osrf/cloudsim-portal/pull-requests/101/_/diff#comment-38930716"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 101, "links": {"self": {"href": "data/repositories/osrf/cloudsim-portal/pullrequests/101.json"}, "html": {"href": "#!/osrf/cloudsim-portal/pull-requests/101"}}, "title": "Delete Metric Configs"}, "content": {"raw": "Thanks @andres_fortier and @preyna ! I included the test to check that a non-existent resource can't be deleted in [this commit](#!/osrf/cloudsim-portal/commits/a4c666585e965a57c219d652f5fe951c0e14ba61?at=default). I also fixed a typo in [this commit](#!/osrf/cloudsim-portal/commits/a4d1a7fafbf20fa5bf9763d09c764822734e4bc6?at=default) (Acc**c**ept -> Accept).\n\nI found something strange while checking this test: I think that if a non-existent resource tries to be deleted, the error returned should be `404`. Instead, we are receiving `401` with an error message that the user has no permission over the resource. Same is true for modifying a non-existent resource.\n\nThis comes from [line 182](#!/osrf/cloudsim-portal/src/a4d1a7fafbf20fa5bf9763d09c764822734e4bc6/server/metric_configs.js?fileviewer=file-view-default#metric_configs.js-182): `csgrant.ownsResource(':resourceId', false)`. It checks that the user has no permission over the resource, rather than checking for the existence of it first. It is also used in `POST` and `PUT`. Should `cloudsim-grant` be in charge of verifying the existence of a resource? I think it could make sense to have a `.hasResource` method before the `.ownsResource`\n\n\u200c", "markup": "markdown", "html": "<p>Thanks @andres_fortier and @preyna ! I included the test to check that a non-existent resource can't be deleted in <a data-is-external-link=\"true\" href=\"#!/osrf/cloudsim-portal/commits/a4c666585e965a57c219d652f5fe951c0e14ba61?at=default\" rel=\"nofollow\">this commit</a>. I also fixed a typo in <a data-is-external-link=\"true\" href=\"#!/osrf/cloudsim-portal/commits/a4d1a7fafbf20fa5bf9763d09c764822734e4bc6?at=default\" rel=\"nofollow\">this commit</a> (Acc<strong>c</strong>ept -&gt; Accept).</p>\n<p>I found something strange while checking this test: I think that if a non-existent resource tries to be deleted, the error returned should be <code>404</code>. Instead, we are receiving <code>401</code> with an error message that the user has no permission over the resource. Same is true for modifying a non-existent resource.</p>\n<p>This comes from <a data-is-external-link=\"true\" href=\"#!/osrf/cloudsim-portal/src/a4d1a7fafbf20fa5bf9763d09c764822734e4bc6/server/metric_configs.js?fileviewer=file-view-default#metric_configs.js-182\" rel=\"nofollow\">line 182</a>: <code>csgrant.ownsResource(':resourceId', false)</code>. It checks that the user has no permission over the resource, rather than checking for the existence of it first. It is also used in <code>POST</code> and <code>PUT</code>. Should <code>cloudsim-grant</code> be in charge of verifying the existence of a resource? I think it could make sense to have a <code>.hasResource</code> method before the <code>.ownsResource</code></p>\n<p>\u200c</p>", "type": "rendered"}, "created_on": "2017-06-15T17:59:49.127541+00:00", "user": {"display_name": "Germ\u00e1n M\u00e1s", "uuid": "{4135c724-adb3-4ffb-a983-57bf615c4d1c}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4135c724-adb3-4ffb-a983-57bf615c4d1c%7D"}, "html": {"href": "https://bitbucket.org/%7B4135c724-adb3-4ffb-a983-57bf615c4d1c%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ebe9f39d-0ca2-4f29-82cf-6cc3df017384/b758f5b1-8d6c-4aa7-8106-ebf2b29bc9a9/128"}}, "nickname": "Germ\u00e1n M\u00e1s", "type": "user", "account_id": "557058:ebe9f39d-0ca2-4f29-82cf-6cc3df017384"}, "updated_on": "2017-06-15T18:01:43.524503+00:00", "type": "pullrequest_comment", "id": 38930716}